import{g as u,j as e,S as A}from"./index-CHTdgF_E.js";import{r as x}from"./vendor-react-DcqtUZ_G.js";import{c as P}from"./commonService-BiflZzQc.js";import{U as B,s as j,H as s,E as F,i as I,w as n,J as O,K as o,I as V}from"./vendor-antd-BiNc4BQP.js";import{c as $,a as k,p as R,o as U}from"./options-CwsqYUdd.js";import T from"./addBrand-Fpoem7KT.js";const z=r=>u.get({url:"/charge-point-brand-models/",params:r}),D=r=>u.get({url:`/charge-point-brand-models/${r}/`}),W=r=>u.post({url:"/charge-point-brand-models/",data:r}),H=r=>u.post({url:"/charge-point-brand-models/bulk-delete/",data:r}),J=(r,d)=>u.put({url:`/charge-point-brand-models/${r}/`,data:d}),C={queryAll:z,queryById:D,add:W,del:H,update:J};function K({folder:r,successCallback:d}){const g=async b=>{const{file:p,onSuccess:l,onError:h}=b;try{const t=new FormData;t.append("picture",p),t.append("folder",r);const i=await P.uploadImage(t);i.code===200&&(l(i,p),d(`${i.detail.preview_url}`),j.success(i.message))}catch(t){h(t),j.error("Image upload failed!")}};return e.jsx(B,{listType:"picture-card",customRequest:g,showUploadList:!1,children:e.jsxs("div",{className:"upload-inner",children:[e.jsx(A,{icon:"Add",size:"20",color:"#1CAE70"}),e.jsx("div",{style:{marginTop:4},children:"Upload Picture"})]})})}function L({visible:r,onClose:d,brandModels:g,updateBrandModels:b,brandMap:p,record:l,onSave:h}){const[t]=s.useForm(),[i,f]=x.useState(!1),[_,v]=x.useState(l?.picture||""),[w,y]=x.useState("");x.useEffect(()=>{if(r&&l){if(t.setFieldsValue(l),l&&l.picture){v(l.picture);const a=l.picture.match(P.imageRegex);a&&y(a[0])}}else r&&(t.resetFields(),v(""),y(""))},[r,l]);const M=()=>{t.validateFields().then(async a=>{const c={...a,brand_id:p[a.brand],picture:w};if(delete c.brand,l&&l.id){const m=await C.update(l.id,c);m?.code===200&&(j.success(m.message),h(),d())}else{const m=await C.add(c);m?.code===200&&(j.success(m.message),h(),d())}})},q=a=>{b(a),t.setFieldsValue({brand:a.brand}),f(!1)},E=()=>{t.setFieldsValue({brand_model:void 0})},S=a=>{t.setFieldsValue({connector_type:a==="AC"?"ac - type2":"dc - ccs2"})},N=a=>{v(a);const c=a.match(P.imageRegex);c&&y(c[0])};return e.jsxs(e.Fragment,{children:[e.jsx(F,{title:l?"Edit Charge Point Brand Model":"Add Charge Point Brand Model",open:r,onCancel:d,zIndex:1001,footer:[e.jsxs("div",{className:"footer-normal-btns",children:[e.jsx(I,{onClick:d,children:"Cancel"},"cancel"),e.jsx(I,{type:"primary",onClick:M,children:l?"Confirm":"Add"},"confirm")]},"edit-brand-footer")],children:e.jsx("div",{className:"modal-form",children:e.jsxs(s,{form:t,layout:"vertical",children:[e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"brand",label:"Brand",rules:[{required:!0,message:"Please select a brand"}],children:e.jsx(n,{onChange:E,placeholder:"Select",disabled:!!l,dropdownRender:a=>e.jsxs("div",{children:[a,e.jsx("div",{className:"p-2",children:e.jsxs(I,{type:"link",onClick:()=>f(!0),children:[e.jsx(O,{})," Add Brand"]})})]}),children:Object.keys(g).map((a,c)=>e.jsx(n.Option,{value:a,children:a},`${a}${c}`))})}),e.jsx(s.Item,{name:"brand_model",label:"Brand Model",rules:[{required:!0,message:"Please Input a brand model"}],children:e.jsx(o,{placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"charge_model",label:"Charge Model",rules:[{required:!0,message:"Please select a charge model"}],children:e.jsx(n,{placeholder:"Select",onChange:a=>S(a),children:$.map(a=>e.jsx(n.Option,{value:a,children:a},a))})}),e.jsx(s.Item,{name:"connector_type",label:"Connector Type",rules:[{required:!0,message:"Please select a connector type"}],children:e.jsx(o,{disabled:!0,placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"connector_no",label:"Connector No",rules:[{required:!0,message:"Please select a connector number"}],children:e.jsx(n,{placeholder:"Select",children:k.map(a=>e.jsx(n.Option,{value:a,children:a},a))})}),e.jsx(s.Item,{name:"phase",label:"Phase",rules:[{required:!0,message:"Please enter the phase"}],children:e.jsx(n,{placeholder:"Select",children:R.map(a=>e.jsx(n.Option,{value:a,children:a},a))})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"ocpp",label:"OCPP",rules:[{required:!0,message:"Please enter the OCPP"}],children:e.jsx(n,{placeholder:"Select",children:U.map(a=>e.jsx(n.Option,{value:a,children:a},a))})}),e.jsx(s.Item,{label:""})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"out_current_min",label:"Current Min(A)",rules:[{required:!0,message:"Please enter the min current"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})}),e.jsx(s.Item,{name:"out_current_max",label:"Current Max(A)",rules:[{required:!0,message:"Please enter the max current"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"out_voltage_min",label:"Voltage Min(V)",rules:[{required:!0,message:"Please enter the min voltage"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})}),e.jsx(s.Item,{name:"out_voltage_max",label:"Voltage Max(V)",rules:[{required:!0,message:"Please enter the max voltage"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"out_power_min",label:"Power Min(kW)",rules:[{required:!0,message:"Please enter the min power"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})}),e.jsx(s.Item,{name:"out_power_max",label:"Power Max(kW)",rules:[{required:!0,message:"Please enter the max power"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})})]}),e.jsx(s.Item,{name:"picture",label:"Picture",children:e.jsxs("div",{className:"upload-wrapper",children:[_&&e.jsx(V,{src:_,preview:!1,className:"entity-image mr-4 object-cover"}),e.jsx(K,{folder:"charge_point_brand_model",successCallback:N})]})})]})})}),e.jsx(T,{visible:i,onClose:()=>f(!1),onAdd:q})]})}const ae=Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"}));export{L as E,C as c,ae as e};
