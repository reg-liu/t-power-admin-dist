import{g as u,j as e,S as E}from"./index-DhvWnTCd.js";import{r as y}from"./vendor-react-BcJS7s_i.js";import{c as N}from"./commonService-ClLo6tnF.js";import{U as S,s as x,H as a,E as A,i as I,w as t,J as B,K as o,I as F}from"./vendor-antd-B62eGpCx.js";import{c as O,a as V,p as $,o as k}from"./options-DbBeB8Zg.js";import R from"./addBrand-DYmPfAcD.js";const U=r=>u.get({url:"/charge-point-brand-models/",params:r}),T=r=>u.get({url:`/charge-point-brand-models/${r}/`}),z=r=>u.post({url:"/charge-point-brand-models/",data:r}),D=r=>u.post({url:"/charge-point-brand-models/bulk-delete/",data:r}),W=(r,d)=>u.put({url:`/charge-point-brand-models/${r}/`,data:d}),_={queryAll:U,queryById:T,add:z,del:D,update:W};function H({folder:r,successCallback:d}){const j=async g=>{const{file:p,onSuccess:l,onError:h}=g;try{const n=new FormData;n.append("picture",p),n.append("folder",r);const c=await N.uploadImage(n);c.code===200&&(l(c,p),d(`${c.detail.preview_url}`),x.success(c.message))}catch(n){h(n),x.error("Image upload failed!")}};return e.jsx(S,{listType:"picture-card",customRequest:j,showUploadList:!1,children:e.jsxs("div",{className:"upload-inner",children:[e.jsx(E,{icon:"Add",size:"20",color:"#1CAE70"}),e.jsx("div",{style:{marginTop:4},children:"Upload Picture"})]})})}function J({visible:r,onClose:d,brandModels:j,updateBrandModels:g,brandMap:p,record:l,onSave:h}){const[n]=a.useForm(),[c,b]=y.useState(!1),[f,v]=y.useState(l?.picture||"");y.useEffect(()=>{r&&l?(n.setFieldsValue(l),v(l.picture)):r&&(n.resetFields(),v(""))},[r,l]);const P=()=>{n.validateFields().then(async s=>{const i={...s,brand_id:p[s.brand],picture:f};if(delete i.brand,l&&l.id){const m=await _.update(l.id,i);m?.code===200&&(x.success(m.message),h(),d())}else{const m=await _.add(i);m?.code===200&&(x.success(m.message),h(),d())}})},C=s=>{g(s),n.setFieldsValue({brand:s.brand}),b(!1)},w=()=>{n.setFieldsValue({brand_model:void 0})},M=s=>{n.setFieldsValue({connector_type:s==="AC"?"ac - type2":"dc - ccs2"})},q=s=>{v(s)};return e.jsxs(e.Fragment,{children:[e.jsx(A,{title:l?"Edit Charge Point Brand Model":"Add Charge Point Brand Model",open:r,onCancel:d,zIndex:1001,footer:[e.jsxs("div",{className:"footer-normal-btns",children:[e.jsx(I,{onClick:d,children:"Cancel"},"cancel"),e.jsx(I,{type:"primary",onClick:P,children:l?"Confirm":"Add"},"confirm")]},"edit-brand-footer")],children:e.jsx("div",{className:"modal-form",children:e.jsxs(a,{form:n,layout:"vertical",children:[e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"brand",label:"Brand",rules:[{required:!0,message:"Please select a brand"}],children:e.jsx(t,{onChange:w,placeholder:"Select",disabled:!!l,dropdownRender:s=>e.jsxs("div",{children:[s,e.jsx("div",{className:"p-2",children:e.jsxs(I,{type:"link",onClick:()=>b(!0),children:[e.jsx(B,{})," Add Brand"]})})]}),children:Object.keys(j).map((s,i)=>e.jsx(t.Option,{value:s,children:s},`${s}${i}`))})}),e.jsx(a.Item,{name:"brand_model",label:"Brand Model",rules:[{required:!0,message:"Please Input a brand model"}],children:e.jsx(o,{placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"charge_model",label:"Charge Model",rules:[{required:!0,message:"Please select a charge model"}],children:e.jsx(t,{placeholder:"Select",onChange:s=>M(s),children:O.map(s=>e.jsx(t.Option,{value:s,children:s},s))})}),e.jsx(a.Item,{name:"connector_type",label:"Connector Type",rules:[{required:!0,message:"Please select a connector type"}],children:e.jsx(o,{disabled:!0,placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"connector_no",label:"Connector No",rules:[{required:!0,message:"Please select a connector number"}],children:e.jsx(t,{placeholder:"Select",children:V.map(s=>e.jsx(t.Option,{value:s,children:s},s))})}),e.jsx(a.Item,{name:"phase",label:"Phase",rules:[{required:!0,message:"Please enter the phase"}],children:e.jsx(t,{placeholder:"Select",children:$.map(s=>e.jsx(t.Option,{value:s,children:s},s))})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"ocpp",label:"OCPP",rules:[{required:!0,message:"Please enter the OCPP"}],children:e.jsx(t,{placeholder:"Select",children:k.map(s=>e.jsx(t.Option,{value:s,children:s},s))})}),e.jsx(a.Item,{label:""})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"out_current_min",label:"Current Min(A)",rules:[{required:!0,message:"Please enter the min current"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})}),e.jsx(a.Item,{name:"out_current_max",label:"Current Max(A)",rules:[{required:!0,message:"Please enter the max current"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"out_voltage_min",label:"Voltage Min(V)",rules:[{required:!0,message:"Please enter the min voltage"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})}),e.jsx(a.Item,{name:"out_voltage_max",label:"Voltage Max(V)",rules:[{required:!0,message:"Please enter the max voltage"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"out_power_min",label:"Power Min(kW)",rules:[{required:!0,message:"Please enter the min power"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})}),e.jsx(a.Item,{name:"out_power_max",label:"Power Max(kW)",rules:[{required:!0,message:"Please enter the max power"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})})]}),e.jsx(a.Item,{name:"picture",label:"Picture",children:e.jsxs("div",{className:"upload-wrapper",children:[f&&e.jsx(F,{src:f,preview:!1,className:"entity-image mr-4 object-cover"}),e.jsx(H,{folder:"charge_point_brand_model",successCallback:q})]})})]})})}),e.jsx(R,{visible:c,onClose:()=>b(!1),onAdd:C})]})}const Z=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));export{J as E,_ as c,Z as e};
