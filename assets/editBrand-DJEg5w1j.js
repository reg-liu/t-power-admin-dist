import{g as u,j as e,S as B}from"./index-DojVPh2z.js";import{r as h}from"./vendor-react-BcJS7s_i.js";import{U as w,E as y,H as l,z as S,i as b,v as i,J as q,K as o,I as V}from"./vendor-antd-IarLURi0.js";import F from"./addBrand-6XMLg0QR.js";const D=()=>u.get({url:"/charge-point-brands/"}),$=s=>u.post({url:"/image-upload/",data:s}),k={getBrands:D,uploadImage:$},T=s=>u.get({url:"/charge-point-brand-models/",params:s}),Y=s=>u.get({url:`/charge-point-brand-models/${s}/`}),O=s=>u.post({url:"/charge-point-brand-models/",data:s}),R=s=>u.delete({url:`/charge-point-brand-models/${s}/`}),U=(s,d)=>u.put({url:`/charge-point-brand-models/${s}/`,data:d}),C={queryAll:T,queryById:Y,add:O,del:R,update:U};function z({folder:s,successCallback:d}){const n=async x=>{const{file:r,onSuccess:g,onError:m}=x;try{const c=new FormData;c.append("picture",r),c.append("folder",s);const j=await k.uploadImage(c);g(j,r),d(`http://test.tpterp.com:8002/${j.picture_path}`),y.success("Image uploaded successfully!")}catch(c){m(c),y.error("Image upload failed!")}};return e.jsx(w,{listType:"picture-card",customRequest:n,showUploadList:!1,children:e.jsxs("div",{className:"upload-inner",children:[e.jsx(B,{icon:"Add",size:"20",color:"#1CAE70"}),e.jsx("div",{style:{marginTop:4},children:"Upload Picture"})]})})}const{Option:t}=i;function L({visible:s,onClose:d,record:n,onSave:x}){const[r]=l.useForm(),[g,m]=h.useState(!1),[c,j]=h.useState(["Tesla","Nissan","BYD"]),[v,I]=h.useState(n?.picture||""),[f,P]=h.useState({Tesla:["Model S","Model 3","Model X"],Nissan:["Nissan LEAF","Nissan Ariya","Nissan e-NV200"],BYD:["BYD Tang EV","BYD Qin EV","BYD Yuan EV"]});h.useEffect(()=>{s&&n?r.setFieldsValue(n):s&&r.resetFields()},[s,n,r]);const _=()=>{r.validateFields().then(async a=>{const p={...a,picture:v};n.id?(await C.update(n.id,p),x(),d()):(await C.add(p),x(),d())})},E=(a,p)=>{j([...c,a]),P({...f,[a]:p}),r.setFieldsValue({brand:a,brand_model:p[0]}),m(!1)},M=()=>{r.setFieldsValue({brand_model:void 0})},N=a=>{r.setFieldsValue({connector_type:a==="AC"?"ac - type2":"dc - ccs2"})},A=a=>{I(a)};return e.jsxs(e.Fragment,{children:[e.jsx(S,{title:n?"Edit Charge Point Brand Model":"Add Charge Point Brand Model",visible:s,onCancel:d,zIndex:1001,footer:[e.jsxs("div",{className:"footer-normal-btns",children:[e.jsx(b,{onClick:d,children:"Cancel"},"cancel"),e.jsx(b,{type:"primary",onClick:_,children:n?"Confirm":"Add"},"confirm")]})],children:e.jsx("div",{className:"modal-form",children:e.jsxs(l,{form:r,layout:"vertical",children:[e.jsxs("div",{className:"two-column",children:[e.jsx(l.Item,{name:"brand",label:"Brand",rules:[{required:!0,message:"Please select a brand"}],children:e.jsx(i,{onChange:M,placeholder:"Select",disabled:!!n,dropdownRender:a=>e.jsxs("div",{children:[a,e.jsx("div",{className:"p-2",children:e.jsxs(b,{type:"link",onClick:()=>m(!0),children:[e.jsx(q,{})," Add Brand"]})})]}),children:c.map(a=>e.jsx(t,{value:a,children:a},a))})}),e.jsx(l.Item,{name:"brand_model",label:"Brand Model",rules:[{required:!0,message:"Please select a brand model"}],children:e.jsx(i,{placeholder:"Select",children:r.getFieldValue("brand")&&f[r.getFieldValue("brand")]?.map(a=>e.jsx(t,{value:a,children:a},a))})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(l.Item,{name:"charge_model",label:"Charge Model",rules:[{required:!0,message:"Please select a charge model"}],children:e.jsxs(i,{placeholder:"Select",onChange:a=>N(a),children:[e.jsx(t,{value:"AC",children:"AC"}),e.jsx(t,{value:"DC",children:"DC"})]})}),e.jsx(l.Item,{name:"connector_type",label:"Connector Type",rules:[{required:!0,message:"Please select a connector type"}],children:e.jsx(o,{disabled:!0,placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(l.Item,{name:"connector_no",label:"Connector No",rules:[{required:!0,message:"Please select a connector number"}],children:e.jsxs(i,{placeholder:"Select",children:[e.jsx(t,{value:1,children:"1"}),e.jsx(t,{value:2,children:"2"})]})}),e.jsx(l.Item,{name:"phase",label:"Phase",rules:[{required:!0,message:"Please enter the phase"}],children:e.jsxs(i,{placeholder:"Select",children:[e.jsx(t,{value:"1p+n",children:"1p+n"}),e.jsx(t,{value:"3p+n",children:"3p+n"})]})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(l.Item,{name:"ocpp",label:"OCPP",rules:[{required:!0,message:"Please enter the OCPP"}],children:e.jsxs(i,{placeholder:"Select",children:[e.jsx(t,{value:"ocpp2.0.1",children:"ocpp2.0.1"}),e.jsx(t,{value:"ocpp1.6",children:"ocpp1.6"})]})}),e.jsx(l.Item,{name:"",label:""})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(l.Item,{name:"out_current_min",label:"Current Min(A)",rules:[{required:!0,message:"Please enter the min current"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})}),e.jsx(l.Item,{name:"out_current_max",label:"Current Max(A)",rules:[{required:!0,message:"Please enter the max current"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(l.Item,{name:"out_voltage_min",label:"Voltage Min(V)",rules:[{required:!0,message:"Please enter the min voltage"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})}),e.jsx(l.Item,{name:"out_voltage_max",label:"Voltage Max(V)",rules:[{required:!0,message:"Please enter the max voltage"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(l.Item,{name:"out_power_min",label:"Power Min(kW)",rules:[{required:!0,message:"Please enter the min power"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})}),e.jsx(l.Item,{name:"out_power_max",label:"Power Max(kW)",rules:[{required:!0,message:"Please enter the max power"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})})]}),e.jsx(l.Item,{name:"picture",label:"Picture",valuePropName:"fileList",getValueFromEvent:a=>Array.isArray(a)?a:a&&a.fileList,children:e.jsxs("div",{className:"upload-wrapper",children:[n&&e.jsx(V,{src:v,preview:!1,width:236,className:"entity-image mr-4 object-cover"}),e.jsx(z,{folder:"charge_point_brand_model",successCallback:A})]})})]})})}),e.jsx(F,{visible:g,onClose:()=>m(!1),onAdd:E})]})}const Q=Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"}));export{L as E,C as a,k as c,Q as e};
