import{g as i,j as e,S as B}from"./index-DHC5svTa.js";import{r as x}from"./vendor-react-BcJS7s_i.js";import{c as N}from"./commonService-DaAigPGr.js";import{U as F,s as I,H as a,E as V,i as v,w as n,J as O,K as o,I as R}from"./vendor-antd-B62eGpCx.js";import $ from"./addBrand-DPTp5SrX.js";const k=s=>i.get({url:"/charge-point-brand-models/",params:s}),U=s=>i.get({url:`/charge-point-brand-models/${s}/`}),D=s=>i.post({url:"/charge-point-brand-models/",data:s}),T=s=>i.delete({url:`/charge-point-brand-models/${s}/`}),z=(s,d)=>i.put({url:`/charge-point-brand-models/${s}/`,data:d}),P={queryAll:k,queryById:U,add:D,del:T,update:z};function L({folder:s,successCallback:d}){const u=async j=>{const{file:m,onSuccess:t,onError:p}=j;try{const l=new FormData;l.append("picture",m),l.append("folder",s);const h=await N.uploadImage(l);t(h,m),d(`http://test.tpterp.com:8002/api/${h.picture_path}`),I.success("Image uploaded successfully!")}catch(l){p(l),I.error("Image upload failed!")}};return e.jsx(F,{listType:"picture-card",customRequest:u,showUploadList:!1,children:e.jsxs("div",{className:"upload-inner",children:[e.jsx(B,{icon:"Add",size:"20",color:"#1CAE70"}),e.jsx("div",{style:{marginTop:4},children:"Upload Picture"})]})})}const{Option:c}=n;function W({visible:s,onClose:d,brandModels:u,updateBrandModels:j,brandMap:m,record:t,onSave:p}){const[l]=a.useForm(),[h,g]=x.useState(!1),[y,_]=x.useState([]),[b,C]=x.useState(t?.picture||"");x.useEffect(()=>{s&&t?(l.setFieldsValue(t),C("")):s&&l.resetFields()},[s,t,l]);const w=()=>{l.validateFields().then(async r=>{const f={...r,brand_id:m[r.brand],picture:b};delete f.brand,t&&t.id?(await P.update(t.id,f))?.error||(p(),d()):(await P.add(f))?.error||(p(),d())})},A=r=>{j(),l.setFieldsValue({brand:r}),g(!1)},M=()=>{l.setFieldsValue({brand_model:void 0}),_(u[l.getFieldValue("brand")])},q=r=>{l.setFieldsValue({connector_type:r==="AC"?"ac - type2":"dc - ccs2"})},E=r=>{C(r)};return e.jsxs(e.Fragment,{children:[e.jsx(V,{title:t?"Edit Charge Point Brand Model":"Add Charge Point Brand Model",visible:s,onCancel:d,zIndex:1001,footer:[e.jsxs("div",{className:"footer-normal-btns",children:[e.jsx(v,{onClick:d,children:"Cancel"},"cancel"),e.jsx(v,{type:"primary",onClick:w,children:t?"Confirm":"Add"},"confirm")]})],children:e.jsx("div",{className:"modal-form",children:e.jsxs(a,{form:l,layout:"vertical",children:[e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"brand",label:"Brand",rules:[{required:!0,message:"Please select a brand"}],children:e.jsx(n,{onChange:M,placeholder:"Select",disabled:!!t,dropdownRender:r=>e.jsxs("div",{children:[r,e.jsx("div",{className:"p-2",children:e.jsxs(v,{type:"link",onClick:()=>g(!0),children:[e.jsx(O,{})," Add Brand"]})})]}),children:Object.keys(u).map(r=>e.jsx(n.Option,{value:r,children:r},r))})}),e.jsx(a.Item,{name:"brand_model",label:"Brand Model",rules:[{required:!0,message:"Please select a brand model"}],children:e.jsx(n,{placeholder:"Select",children:y&&y.map(r=>e.jsx(n.Option,{value:r,children:r},r))})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"charge_model",label:"Charge Model",rules:[{required:!0,message:"Please select a charge model"}],children:e.jsxs(n,{placeholder:"Select",onChange:r=>q(r),children:[e.jsx(c,{value:"AC",children:"AC"}),e.jsx(c,{value:"DC",children:"DC"})]})}),e.jsx(a.Item,{name:"connector_type",label:"Connector Type",rules:[{required:!0,message:"Please select a connector type"}],children:e.jsx(o,{disabled:!0,placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"connector_no",label:"Connector No",rules:[{required:!0,message:"Please select a connector number"}],children:e.jsxs(n,{placeholder:"Select",children:[e.jsx(c,{value:1,children:"1"}),e.jsx(c,{value:2,children:"2"})]})}),e.jsx(a.Item,{name:"phase",label:"Phase",rules:[{required:!0,message:"Please enter the phase"}],children:e.jsxs(n,{placeholder:"Select",children:[e.jsx(c,{value:"1p+n",children:"1p+n"}),e.jsx(c,{value:"3p+n",children:"3p+n"})]})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"ocpp",label:"OCPP",rules:[{required:!0,message:"Please enter the OCPP"}],children:e.jsxs(n,{placeholder:"Select",children:[e.jsx(c,{value:"ocpp2.0.1",children:"ocpp2.0.1"}),e.jsx(c,{value:"ocpp1.6",children:"ocpp1.6"})]})}),e.jsx(a.Item,{name:"",label:""})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"out_current_min",label:"Current Min(A)",rules:[{required:!0,message:"Please enter the min current"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})}),e.jsx(a.Item,{name:"out_current_max",label:"Current Max(A)",rules:[{required:!0,message:"Please enter the max current"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"out_voltage_min",label:"Voltage Min(V)",rules:[{required:!0,message:"Please enter the min voltage"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})}),e.jsx(a.Item,{name:"out_voltage_max",label:"Voltage Max(V)",rules:[{required:!0,message:"Please enter the max voltage"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"out_power_min",label:"Power Min(kW)",rules:[{required:!0,message:"Please enter the min power"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})}),e.jsx(a.Item,{name:"out_power_max",label:"Power Max(kW)",rules:[{required:!0,message:"Please enter the max power"}],children:e.jsx(o,{type:"number",placeholder:"Enter"})})]}),e.jsx(a.Item,{name:"picture",label:"Picture",valuePropName:"fileList",getValueFromEvent:r=>Array.isArray(r)?r:r&&r.fileList,children:e.jsxs("div",{className:"upload-wrapper",children:[b&&e.jsx(R,{src:b,preview:!1,width:236,className:"entity-image mr-4 object-cover"}),e.jsx(L,{folder:"charge_point_brand_model",successCallback:E})]})})]})})}),e.jsx($,{visible:h,onClose:()=>g(!1),onAdd:A})]})}const X=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"}));export{W as E,P as c,X as e};
