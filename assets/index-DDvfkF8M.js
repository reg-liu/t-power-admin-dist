import{h as oe,j as e,S as c,f as I}from"./index-D17-YFjw.js";import{r as a}from"./vendor-react-BcJS7s_i.js";import{c as le}from"./commonService-C9rSV1Vx.js";import{C as ce,c as $}from"./chargepointUserDetail-mc7M0BhM.js";import re from"./addChargepoint-BBeo4KYL.js";import de from"./editLocation-DxjBXn2i.js";import me from"./unbindUser-v2AEVxpM.js";import{K as he,w as C,i as o,x as f,P as g,F as ue,y as M,j as xe,I as pe,z as je,s as fe}from"./vendor-antd-B62eGpCx.js";import"./vendor-ui-DPkccqlC.js";import"./vendor-utils-CtEfXJzW.js";import"./index-DGu3TDlq.js";import"./index.modern-BgdPXcnK.js";import"./vendor-charts-Cv5x1InZ.js";import"./index-Dj133iwh.js";const{Option:v}=C;function Pe(){const[m,x]=a.useState({page:1}),[D,l]=a.useState(0),[P,z]=a.useState(null),[h,A]=a.useState("name"),[B,L]=a.useState(),[r,T]=a.useState([]),[V,E]=a.useState(0),[b,R]=a.useState("list"),[i,u]=a.useState([]),[K,_]=a.useState(!1),[q,y]=a.useState(!1),[F,p]=a.useState(!1);a.useState(!1);const[G,w]=a.useState(!1),O=oe(),J=[],N=s=>{z(s),_(!0)},Q=[{title:"Charge Point",dataIndex:"id_tag",key:"id_tag",className:"bold",render:(s,t)=>e.jsx(o,{type:"link",onClick:()=>N(t),children:s})},{title:"User",dataIndex:"user",key:"user"},{title:"Location",dataIndex:"location",key:"location",render:s=>e.jsx("div",{className:"display-row location",children:e.jsx("div",{className:"row-item",children:`${s.cp_suburb} ${s.cp_state} ${s.cp_postcode}`})})},{title:"Operation",width:"140px",key:"operation",render:(s,t)=>e.jsx("div",{className:"operations",children:e.jsx(g,{placement:"bottom",okText:"Confirm",cancelText:"Cancel",title:"Confirm unbind?",onConfirm:()=>S(t.id),children:e.jsx(o,{type:"link",icon:e.jsx(c,{icon:"Unbind",size:"20"}),children:"Unbind"})})})}],H=()=>{p(!0)},W={selectedRowKeys:i,onChange:s=>{u(s)}},X=e.jsxs(C,{value:h,onChange:A,style:{width:156},children:[e.jsx(v,{value:"name",children:"Charge Point"}),e.jsx(v,{value:"sn",children:"SN"})]}),Y=()=>{i.length===r.length?u([]):u(r.map(s=>s.key))},S=async s=>{try{const t=await $.unbind(s);t?.code===200&&(fe.success(t.message),l(Date.now()))}catch{}},Z=()=>{l(Date.now())},ee=s=>{x({...m,page:s}),l(Date.now())},se=s=>s.map(t=>{const{id:d,first_name:j,last_name:ne,charge_point:k}=t,{charge_point_detail:U,brand_model:n,sn:ie}=k;return{id:d,user:`${j} ${ne}`,picture:n.picture,location:U,latlng:U.latlng,key:`${t.id}${le.rowKeySplit}${t.charge_point_id}`,sn:ie,id_tag:k.id_tag,brand:n.brand,brand_model:n.brand_model,charge_model:n.charge_model,connector_no:n.connector_no,ocpp:n.ocpp,phase:n.phase,out_current_max:parseInt(`${n.out_current_max}`,10),out_current_min:parseInt(`${n.out_current_min}`,10),out_power_max:parseInt(`${n.out_power_max}`,10),out_power_min:parseInt(`${n.out_power_min}`,10),out_voltage_max:parseInt(`${n.out_voltage_max}`,10),out_voltage_min:parseInt(`${n.out_voltage_min}`,10),connector_type:n.charge_model==="AC"?"ac - type2":"dc - ccs2"}}),ae=()=>{x({}),l(Date.now())},te=async()=>{const s=await $.queryAll(m),{results:t,count:d}=s.detail;T(se(t||[])),E(d)};return a.useEffect(()=>{te()},[D]),a.useEffect(()=>{l(Date.now())},[]),e.jsxs("div",{className:"main-content",children:[e.jsxs("div",{className:"search-area flex items-center justify-start",children:[e.jsxs("div",{className:"search-item",children:[e.jsx("div",{className:"label",children:"Enter"}),e.jsx(he,{addonBefore:X,placeholder:h==="name"?"Charge Point":"SN",allowClear:!0,value:m[h],onChange:s=>x({...m,[h]:s.target.value})})]}),e.jsxs("div",{className:"search-item",children:[e.jsx("div",{className:"label",children:"User"}),e.jsx(C,{className:"w-full",allowClear:!0,value:B,style:{width:"150px"},onChange:s=>L(s),placeholder:"User",children:J.map(s=>e.jsx(v,{value:s.name,children:s.name},s.name))})]}),e.jsx("div",{className:"search-btn",children:e.jsx(o,{icon:e.jsx(c,{icon:"Search",size:"20"}),type:"primary",onClick:Z})}),e.jsx("div",{className:"search-btn clear",children:e.jsx(o,{icon:e.jsx(c,{icon:"Close",size:"24",color:"#999"}),type:"primary",onClick:ae})})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"operation-area flex items-center justify-start",children:[e.jsxs(f.Group,{className:"layout-switch",value:b,onChange:s=>R(s.target.value),children:[e.jsx(f.Button,{value:"list",children:e.jsxs("div",{className:"layout-switch-item",children:[e.jsx(I,{icon:"mynaui:list",size:20}),"List"]})}),e.jsx(f.Button,{value:"grid",children:e.jsxs("div",{className:"layout-switch-item",children:[e.jsx(I,{icon:"proicons:grid",size:20}),"Grid"]})})]}),O&&e.jsx(o,{icon:e.jsx(c,{icon:"Bind",size:"20"}),type:"primary",onClick:H,className:"ml-3 mr-3",children:"Bind User and Charge Point"}),e.jsx(g,{placement:"bottom",okText:"Confirm",cancelText:"Cancel",title:"Confirm unbind?",onConfirm:()=>{},children:e.jsx(o,{disabled:i.length===0,className:"ml-3",icon:e.jsx(c,{icon:"Unbind",size:"20",color:i.length===0?"#999":"currentColor"}),children:"Bulk Unbind"})})]})}),b==="list"?e.jsx(ue,{rowSelection:W,rowKey:"id",columns:Q,bordered:!0,dataSource:r,pagination:!1}):e.jsxs("div",{className:"grid-wrapper",children:[e.jsx(M,{className:"check-all",checked:r.length===i.length,onChange:Y}),e.jsx("div",{className:"grid",children:r.map(s=>e.jsx("div",{className:"grid-item",children:e.jsxs(xe,{children:[e.jsxs("div",{className:"grid-top with-image flex items-center",children:[e.jsx(M,{checked:i.includes(s.id),onChange:t=>{const d=t.target.checked?[...i,s.id]:i.filter(j=>j!==s.id);u(d)}}),e.jsx(pe,{src:s.picture,preview:!1,height:184,className:"entity-image object-cover"})]}),e.jsxs("div",{className:"grid-bottom",children:[e.jsx("div",{className:"display-item",children:e.jsx(o,{type:"link",className:"detail-link",onClick:()=>{N(s)},children:s.id_tag})}),e.jsxs("div",{className:"display-item",children:[e.jsx("span",{className:"label bold",children:"User:"})," ",e.jsx("span",{className:"value",children:e.jsx("div",{children:e.jsx("div",{children:s.user})})})]}),e.jsxs("div",{className:"display-item location",children:[e.jsx("span",{className:"label",children:"Location:"})," ",e.jsx("span",{className:"value",children:e.jsx("span",{className:"mr-1",children:`${s.location.cp_suburb} ${s.location.cp_state} ${s.location.cp_postcode}`})})]}),e.jsx("div",{className:"operation-rows",children:e.jsx(g,{placement:"bottom",okText:"Confirm",cancelText:"Cancel",title:"Confirm unbind?",onConfirm:()=>S(s.id),children:e.jsx(o,{type:"link",icon:e.jsx(c,{icon:"Unbind",size:"20"}),children:"Unbind"})})})]})]},s.id)}))})]}),e.jsx("div",{className:"mr-4 mt-4 flex justify-end",children:e.jsx(je,{total:V,showQuickJumper:!0,onChange:ee})}),e.jsx(ce,{record:P,visible:K,onClose:()=>{_(!1),l(Date.now())}}),e.jsx(de,{visible:q,onCancel:()=>y(!1),onConfirm:()=>y(!1)}),e.jsx(re,{visible:F,onCancel:()=>p(!1),onConfirm:()=>p(!1)}),e.jsx(me,{visible:G,onCancel:()=>w(!1),onConfirm:()=>w(!1)})]})}export{Pe as default};
