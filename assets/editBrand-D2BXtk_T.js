import{j as e,S}from"./index-x526v5wV.js";import{r as p}from"./vendor-react-DcqtUZ_G.js";import{c as P}from"./commonService-jucT3H--.js";import{c as w}from"./cpBrandModelService-BVeKS8m6.js";import{U as A,s as x,H as s,E as B,i as I,w as t,J as F,K as c,I as V}from"./vendor-antd-BiNc4BQP.js";import{c as R,a as k,p as O,o as U}from"./options-MDMYukvs.js";import T from"./addBrand-C2_JNtzY.js";import"./vendor-ui-BASYQBt4.js";import"./vendor-utils-DcB4TerO.js";function $({folder:d,successCallback:o}){const j=async g=>{const{file:u,onSuccess:r,onError:h}=g;try{const l=new FormData;l.append("picture",u),l.append("folder",d);const i=await P.uploadImage(l);i.code===200&&(r(i,u),o(`${i.detail.preview_url}`),x.success(i.message))}catch(l){h(l),x.error("Image upload failed!")}};return e.jsx(A,{listType:"picture-card",customRequest:j,showUploadList:!1,children:e.jsxs("div",{className:"upload-inner",children:[e.jsx(S,{icon:"Add",size:"20",color:"#1CAE70"}),e.jsx("div",{style:{marginTop:4},children:"Upload Picture"})]})})}function X({visible:d,onClose:o,brandModels:j,updateBrandModels:g,brandMap:u,record:r,onSave:h}){const[l]=s.useForm(),[i,b]=p.useState(!1),[C,f]=p.useState(r?.picture||""),[y,v]=p.useState("");p.useEffect(()=>{if(d&&r){if(l.setFieldsValue(r),r&&r.picture){f(r.picture);const a=r.picture.match(P.imageRegex);a&&v(a[0])}}else d&&(l.resetFields(),f(""),v(""))},[d,r]);const _=()=>{l.validateFields().then(async a=>{const n={...a,brand_id:u[a.brand],picture:y};if(delete n.brand,r&&r.id){const m=await w.update(r.id,n);m?.code===200&&(x.success(m.message),h(),o())}else{const m=await w.add(n);m?.code===200&&(x.success(m.message),h(),o())}})},M=a=>{g(a),l.setFieldsValue({brand:a.brand}),b(!1)},E=()=>{l.setFieldsValue({brand_model:void 0})},q=a=>{l.setFieldsValue({connector_type:a==="AC"?"ac - type2":"dc - ccs2"})},N=a=>{f(a);const n=a.match(P.imageRegex);n&&v(n[0])};return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:r?"Edit Charge Point Brand Model":"Add Charge Point Brand Model",open:d,onCancel:o,zIndex:1001,footer:[e.jsxs("div",{className:"footer-normal-btns",children:[e.jsx(I,{onClick:o,children:"Cancel"},"cancel"),e.jsx(I,{type:"primary",onClick:_,children:r?"Confirm":"Add"},"confirm")]},"edit-brand-footer")],children:e.jsx("div",{className:"modal-form",children:e.jsxs(s,{form:l,layout:"vertical",children:[e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"brand",label:"Brand",rules:[{required:!0,message:"Please select a brand"}],children:e.jsx(t,{onChange:E,placeholder:"Select",disabled:!!r,dropdownRender:a=>e.jsxs("div",{children:[a,e.jsx("div",{className:"p-2",children:e.jsxs(I,{type:"link",onClick:()=>b(!0),children:[e.jsx(F,{})," Add Brand"]})})]}),children:Object.keys(j).map((a,n)=>e.jsx(t.Option,{value:a,children:a},`${a}${n}`))})}),e.jsx(s.Item,{name:"brand_model",label:"Brand Model",rules:[{required:!0,message:"Please Input a brand model"}],children:e.jsx(c,{placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"charge_model",label:"Charge Model",rules:[{required:!0,message:"Please select a charge model"}],children:e.jsx(t,{placeholder:"Select",onChange:a=>q(a),children:R.map(a=>e.jsx(t.Option,{value:a,children:a},a))})}),e.jsx(s.Item,{name:"connector_type",label:"Connector Type",rules:[{required:!0,message:"Please select a connector type"}],children:e.jsx(c,{disabled:!0,placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"connector_no",label:"Connector No",rules:[{required:!0,message:"Please select a connector number"}],children:e.jsx(t,{placeholder:"Select",children:k.map(a=>e.jsx(t.Option,{value:a,children:a},a))})}),e.jsx(s.Item,{name:"phase",label:"Phase",rules:[{required:!0,message:"Please enter the phase"}],children:e.jsx(t,{placeholder:"Select",children:O.map(a=>e.jsx(t.Option,{value:a,children:a},a))})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"ocpp",label:"OCPP",rules:[{required:!0,message:"Please enter the OCPP"}],children:e.jsx(t,{placeholder:"Select",children:U.map(a=>e.jsx(t.Option,{value:a,children:a},a))})}),e.jsx(s.Item,{label:""})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"out_current_min",label:"Current Min(A)",rules:[{required:!0,message:"Please enter the min current"}],children:e.jsx(c,{type:"number",placeholder:"Enter"})}),e.jsx(s.Item,{name:"out_current_max",label:"Current Max(A)",rules:[{required:!0,message:"Please enter the max current"}],children:e.jsx(c,{type:"number",placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"out_voltage_min",label:"Voltage Min(V)",rules:[{required:!0,message:"Please enter the min voltage"}],children:e.jsx(c,{type:"number",placeholder:"Enter"})}),e.jsx(s.Item,{name:"out_voltage_max",label:"Voltage Max(V)",rules:[{required:!0,message:"Please enter the max voltage"}],children:e.jsx(c,{type:"number",placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(s.Item,{name:"out_power_min",label:"Power Min(kW)",rules:[{required:!0,message:"Please enter the min power"}],children:e.jsx(c,{type:"number",placeholder:"Enter"})}),e.jsx(s.Item,{name:"out_power_max",label:"Power Max(kW)",rules:[{required:!0,message:"Please enter the max power"}],children:e.jsx(c,{type:"number",placeholder:"Enter"})})]}),e.jsx(s.Item,{name:"picture",label:"Picture",children:e.jsxs("div",{className:"upload-wrapper",children:[C&&e.jsx(V,{src:C,preview:!1,className:"entity-image mr-4 object-cover"}),e.jsx($,{folder:"charge_point_brand_model",successCallback:N})]})})]})})}),e.jsx(T,{visible:i,onClose:()=>b(!1),onAdd:M})]})}export{X as default};
