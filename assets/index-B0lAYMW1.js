import{j as e,S as h,f as P}from"./index-DHC5svTa.js";import{r}from"./vendor-react-BcJS7s_i.js";import{c as J}from"./commonService-DaAigPGr.js";import{E as Q,c as I}from"./editBrand-B0phcJqZ.js";import{e as H}from"./ev-PecoakOh.js";import U from"./brandModelDetail-DaVfv94k.js";import{w as l,i,x as y,P as C,F as X,y as B,j as Y,I as Z,z as ee}from"./vendor-antd-B62eGpCx.js";import"./vendor-ui-DPkccqlC.js";import"./vendor-utils-CtEfXJzW.js";import"./addBrand-DPTp5SrX.js";function he(){const[n,d]=r.useState({}),[t,x]=r.useState([]),[g,O]=r.useState("list"),[m,D]=r.useState([]),[A,E]=r.useState(0),[$,b]=r.useState(!1),[z,w]=r.useState(!1),[j,v]=r.useState(null),[N,R]=r.useState({}),[_,T]=r.useState(null),V=()=>{u()},f=a=>{v(a),b(!0)},k=a=>{v(a||null),w(!0)},F=[{title:"Brand",dataIndex:"brand",key:"brand"},{title:"Brand Model",dataIndex:"brand_model",key:"brand_model",className:"bold",render:(a,s)=>e.jsx(i,{type:"link",onClick:()=>f(s),children:a})},{title:"Charge Model",dataIndex:"charge_model",width:"140px",key:"charge_model"},{title:"Connector No",dataIndex:"connector_no",width:"140px",key:"connector_no"},{title:"Phase",dataIndex:"phase",key:"phase"},{title:"OCPP",dataIndex:"ocpp",key:"ocpp"},{title:"Current Min",dataIndex:"out_current_min",key:"out_current_min",render:a=>e.jsxs("span",{children:[`${a}`,"A"]})},{title:"Current Max",dataIndex:"out_current_max",key:"out_current_max",render:a=>e.jsxs("span",{children:[`${a}`,"A"]})},{title:"Power Min",dataIndex:"out_power_min",key:"out_power_min",render:a=>e.jsxs("span",{children:[`${a}`,"kW"]})},{title:"Power Max",dataIndex:"out_power_max",key:"out_power_max",render:a=>e.jsxs("span",{children:[`${a}`,"kW"]})},{title:"Operation",width:"140px",key:"operation",render:(a,s)=>e.jsx("div",{className:"operations",children:e.jsx(C,{title:"Confirm delete?",placement:"bottom",okText:"Confirm",cancelText:"Cancel",onConfirm:()=>{p(s.id)},children:e.jsx(i,{type:"link",danger:!0,icon:e.jsx(h,{icon:"Delete",size:"20"}),children:"Delete"})})})}],K=()=>{t.length===m.length?x([]):x(m.map(a=>a.id))},M=async()=>{const a=await J.getBrands(),s={},o={};a.forEach(c=>{s[c.brand]=c.id;const S=[];c.chargepointbrandmodel_set.forEach(L=>{S.push(L.brand_model)}),o[c.brand]=S}),T(s),R(o)},p=async a=>{try{const s=await I.del(a?[a]:t)}catch{}},W=a=>a.map(s=>({...s,out_current_max:parseInt(`${s.out_current_max}`,10),out_current_min:parseInt(`${s.out_current_min}`,10),out_power_max:parseInt(`${s.out_power_max}`,10),out_power_min:parseInt(`${s.out_power_min}`,10),out_voltage_max:parseInt(`${s.out_voltage_max}`,10),out_voltage_min:parseInt(`${s.out_voltage_min}`,10),connector_type:s.charge_model==="AC"?"ac - type2":"dc - ccs2"})),q=()=>{M()},u=async()=>{const a={...n};_&&(a.brand_id=_[a.brand],delete a.brand,a.brand_model||delete a.brand_model);const s=await I.queryAll(a),{results:o,count:c}=s;D(W(o||[])),E(c)},G=()=>{d({}),u()};return r.useEffect(()=>{M(),u()},[]),e.jsxs("div",{className:"main-content",children:[e.jsxs("div",{className:"search-area flex items-center justify-start",children:[e.jsxs("div",{className:"search-item",children:[e.jsx("div",{className:"label",children:"Brand"}),e.jsx(l,{className:"w-full",value:n.brand,allowClear:!0,style:{width:"120px"},placeholder:"Brand",onChange:a=>d({...n,brand:a,brand_model:""}),children:Object.keys(N).map(a=>e.jsx(l.Option,{value:a,children:a},a))})]}),e.jsxs("div",{className:"search-item",children:[e.jsx("div",{className:"label",children:"Brand Model"}),e.jsx(l,{className:"w-full",style:{width:"160px"},allowClear:!0,placeholder:"Brand Model",value:n.brand_model,disabled:!n.brand,onChange:a=>d({...n,brand_model:a}),children:n.brand&&N[n.brand].map(a=>e.jsx(l.Option,{value:a,children:a},a))})]}),e.jsxs("div",{className:"search-item",children:[e.jsx("div",{className:"label",children:"Charge Model"}),e.jsxs(l,{className:"w-full",style:{width:"160px"},allowClear:!0,placeholder:"Charge Model",onChange:a=>d({...n,charge_model:a}),children:[e.jsx(l.Option,{value:"AC",children:"AC"}),e.jsx(l.Option,{value:"DC",children:"DC"})]})]}),e.jsxs("div",{className:"search-item",children:[e.jsx("div",{className:"label",children:"OCPP"}),e.jsxs(l,{placeholder:"OCPP",allowClear:!0,style:{width:"210px"},onChange:a=>d({...n,ocpp:a}),children:[e.jsx(l.Option,{value:"ocpp2.0.1",children:"ocpp2.0.1"}),e.jsx(l.Option,{value:"ocpp1.6",children:"ocpp1.6"})]})]}),e.jsxs("div",{className:"search-item",children:[e.jsx("div",{className:"label",children:"Phase"}),e.jsxs(l,{placeholder:"Phase",allowClear:!0,style:{width:"190px"},onChange:a=>d({...n,phase:a}),children:[e.jsx(l.Option,{value:"1p+n",children:"1p+n"}),e.jsx(l.Option,{value:"3p+n",children:"3p+n"})]})]}),e.jsxs("div",{className:"search-item",children:[e.jsx("div",{className:"label",children:"Connector No"}),e.jsxs(l,{className:"w-full",style:{width:"190px"},allowClear:!0,placeholder:"Connector No",onChange:a=>d({...n,connector_no:a}),children:[e.jsx(l.Option,{value:1,children:"1"}),e.jsx(l.Option,{value:2,children:"2"})]})]}),e.jsx("div",{className:"search-btn",children:e.jsx(i,{icon:e.jsx(h,{icon:"Search",size:"20"}),type:"primary",onClick:V})}),e.jsx("div",{className:"search-btn clear",children:e.jsx(i,{icon:e.jsx(h,{icon:"Close",size:"24",color:"#999"}),type:"primary",onClick:G})})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"operation-area flex items-center justify-start",children:[e.jsxs(y.Group,{className:"layout-switch",value:g,onChange:a=>O(a.target.value),children:[e.jsx(y.Button,{value:"list",children:e.jsxs("div",{className:"layout-switch-item",children:[e.jsx(P,{icon:"mynaui:list",size:20}),"List"]})}),e.jsx(y.Button,{value:"grid",children:e.jsxs("div",{className:"layout-switch-item",children:[e.jsx(P,{icon:"proicons:grid",size:20}),"Grid"]})})]}),e.jsx(i,{type:"primary",icon:e.jsx(h,{icon:"Add",size:"20"}),className:"ml-3 mr-3",onClick:()=>k(),children:"Add Brand Model"}),e.jsx(C,{title:"Confirm delete?",onConfirm:()=>{p()},placement:"bottom",okText:"Confirm",cancelText:"Cancel",children:e.jsx(i,{disabled:t.length===0,danger:!0,icon:e.jsx(h,{icon:"Delete",size:"20",color:t.length===0?"#999":"currentColor"}),children:"Bulk Delete"})})]})}),g==="list"?e.jsx(X,{rowSelection:{type:"checkbox",onChange:a=>x(a)},bordered:!0,columns:F,dataSource:m,rowKey:"id",pagination:!1}):e.jsxs("div",{className:"grid-wrapper",children:[e.jsx(B,{className:"check-all",checked:m.length===t.length,onChange:K}),e.jsx("div",{className:"grid",children:m.map(a=>e.jsx("div",{className:"grid-item",children:e.jsxs(Y,{hoverable:!0,className:"flex flex-col",children:[e.jsxs("div",{className:"grid-top with-image flex items-center",children:[e.jsx(B,{checked:t.includes(a.id),onChange:s=>{const o=s.target.checked?[...t,a.id]:t.filter(c=>c!==a.id);x(o)}}),e.jsx(Z,{src:H,preview:!1,height:184,className:"entity-image object-cover"})]}),e.jsxs("div",{className:"grid-bottom",children:[e.jsx("div",{className:"display-item title",children:a.brand}),e.jsxs("div",{className:"display-item",children:[e.jsx("span",{className:"label",children:"Brand Model:"}),e.jsx("span",{className:"value",children:e.jsx(i,{type:"link",onClick:()=>{f(a)},children:e.jsx("span",{className:"bold",children:a.brand_model})})})]}),e.jsxs("div",{className:"display-item",children:[e.jsx("span",{className:"label",children:"Charge Model:"}),e.jsx("span",{className:"value",children:a.charge_model})]}),e.jsxs("div",{className:"display-item",children:[e.jsx("span",{className:"label",children:"Connector No:"}),e.jsx("span",{className:"value",children:a.connector_no})]}),e.jsxs("div",{className:"display-item",children:[e.jsx("span",{className:"label",children:"Phase:"}),e.jsx("span",{className:"value",children:a.phase})]}),e.jsxs("div",{className:"display-item",children:[e.jsx("span",{className:"label",children:"OCPP:"}),e.jsx("span",{className:"value",children:a.ocpp})]}),e.jsxs("div",{className:"display-item",children:[e.jsx("span",{className:"label",children:"Current:"})," ",e.jsxs("span",{className:"value",children:[e.jsxs("span",{className:"value-item",children:[e.jsxs("span",{className:"data",children:[a.out_current_min,"A"]}),e.jsx("span",{className:"tag",children:"min"})]}),e.jsxs("span",{className:"value-item",children:[e.jsxs("span",{className:"data",children:[a.out_current_max,"A"]}),e.jsx("span",{className:"tag",children:"max"})]})]})]}),e.jsxs("div",{className:"display-item",children:[e.jsx("span",{className:"label",children:"Power:"})," ",e.jsx("span",{className:"value",children:e.jsxs("span",{className:"value-item",children:[e.jsxs("span",{className:"data",children:[a.out_power_min,"kW"]}),e.jsx("span",{className:"tag",children:"min"}),e.jsxs("span",{className:"value-item",children:[e.jsxs("span",{className:"data",children:[a.out_power_max,"kW"]}),e.jsx("span",{className:"tag",children:"max"})]})]})})]}),e.jsx("div",{className:"operation-rows",children:e.jsx(C,{title:"Confirm delete?",onConfirm:()=>{p(a.id)},placement:"bottom",okText:"Confirm",cancelText:"Cancel",children:e.jsx(i,{type:"link",danger:!0,icon:e.jsx(h,{icon:"Delete",size:"20",color:"#FF4747"}),children:"Delete"})})})]})]},a.id)}))})]}),e.jsx("div",{className:"mr-4 mt-4 flex justify-end",children:e.jsx(ee,{total:A,showQuickJumper:!0})}),e.jsx(U,{visible:$,onClose:()=>b(!1),onDelete:a=>p(a),chargePoint:j,onEdit:()=>{k(j)}}),e.jsx(Q,{visible:z,onClose:()=>w(!1),record:j,brandModels:N,brandMap:_,updateBrandModels:q,onSave:()=>{u(),v(null)}})]})}export{he as default};
