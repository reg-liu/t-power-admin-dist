import{a as $,k as F,m as R,j as e,S as f,n as w}from"./index-4YVUTv9m.js";import{r as i}from"./vendor-react-DcqtUZ_G.js";import{ReturnButton as T}from"./ReturnButton-1pZbAIh0.js";import{H as t,x as m,K as l,i as q,s as y}from"./vendor-antd-BiNc4BQP.js";import"./vendor-ui-BASYQBt4.js";import"./vendor-utils-DcB4TerO.js";function M(){const v=async s=>{p(!0);const a={password:s.password,code:s.code};r==="phone"?a.phone=s.phone:a.email=s.email;const o=await w.resetPassword(a);p(!1),o?.code===200&&(y.success(o.message),h())},[u]=t.useForm(),{t:n}=$(),{loginState:S,backToLogin:h}=F(),[N,p]=i.useState(!1),[r,b]=i.useState("email"),[d,x]=i.useState("ready"),[P,g]=i.useState(0);if(S!==R.RESET_PASSWORD)return null;const C=async()=>{if(d!=="ready")return;const s=u.getFieldsValue(),a={};if(r==="phone"){if(a.phone=s.phone,!s.phone)return}else if(a.email=s.email,!s.email)return;try{x("sended"),g(60);const o=setInterval(()=>{g(c=>c>0?c-1:(clearInterval(o),x("ready"),c))},1e3),j=await w.resetSendCode(a);j?.code===200&&y.success(j.message)}catch{}},E=e.jsx("div",{className:"country-code-wrapper",children:e.jsx("span",{className:"text",children:"+61"})}),I=e.jsx("div",{className:`send-wrapper ${d!=="ready"?"send-disabled":""}`,onClick:C,children:e.jsx("span",{className:"text",children:d==="sended"?`${P}S`:"Verification Code"})});return e.jsxs("div",{className:"reset-section",children:[e.jsx(T,{onClick:h}),e.jsx("div",{className:"mb-4 text-2xl font-bold xl:text-3xl",children:n("sys.login.forgetFormTitle")}),e.jsxs(m.Group,{className:"login-switch",value:r,onChange:s=>b(s.target.value),children:[e.jsx(m.Button,{value:"email",className:"switch-item",children:e.jsxs("div",{className:"item-inner",children:[e.jsx(f,{icon:r==="email"?"email-active":"email",size:"14"}),"Email"]})}),e.jsx(m.Button,{value:"phone",className:"switch-item",children:e.jsxs("div",{className:"item-inner",children:[e.jsx(f,{icon:r==="phone"?"phone-active":"phone",size:"14"}),"Phone"]})})]}),e.jsxs(t,{name:"normal_login",size:"large",layout:"vertical",form:u,className:"login-form",onFinish:v,children:[e.jsx("div",{className:"mb-4 flex flex-col"}),r==="phone"?e.jsx(t.Item,{name:"phone",label:n("sys.login.phone"),rules:[{required:!0,message:n("sys.login.phonePlaceholder")},{pattern:/^\d{9,}$/,message:"Phone number must be at least 9 digits!"}],children:e.jsx(l,{placeholder:"Enter",addonBefore:E,allowClear:!0})}):e.jsx(t.Item,{name:"email",label:n("sys.login.email"),rules:[{required:!0,message:n("sys.login.emailPlaceholder")},{type:"email",message:"Please enter a valid email address!"}],children:e.jsx(l,{placeholder:"Enter"})}),e.jsx(t.Item,{name:"code",label:"Verification Code",rules:[{required:!0,message:"Please input Code"},{pattern:/^\d{4}$/,message:"Code must be exactly 4 digits!"}],children:e.jsxs("div",{children:[e.jsx(l,{className:"code-input",addonAfter:I}),e.jsx("div",{className:"password-rule",children:"Please enter the 4-digit code sent to your email/phone at [email/phone]"})]})}),e.jsx(t.Item,{name:"password",label:"New Password",rules:[{required:!0,message:n("sys.login.passwordPlaceholder")},{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,message:"The password needs to meet the above requirements"}],children:e.jsxs("div",{children:[e.jsx(l.Password,{type:"password",placeholder:"Enter"}),e.jsx("div",{className:"password-rule",children:"Your password must include at least 8 characters, with at least one uppercase letter, one lowercase letter, one number and one special character."})]})}),e.jsx(t.Item,{children:e.jsx(q,{type:"primary",htmlType:"submit",className:"w-full",loading:N,children:"Confirm"})})]})]})}export{M as default};
