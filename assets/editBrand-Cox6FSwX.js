import{g as p,j as e,S as A}from"./index-DGG3uvmK.js";import{r as C}from"./vendor-react-BcJS7s_i.js";import{c as S}from"./commonService-BLSpsRcW.js";import{U as B,s as j,H as a,E as N,i as y,w as o,J as F,K as d,I as V}from"./vendor-antd-B62eGpCx.js";import $ from"./addBrand-4w84FFId.js";const k=r=>p.get({url:"/charge-point-brand-models/",params:r}),O=r=>p.get({url:`/charge-point-brand-models/${r}/`}),R=r=>p.post({url:"/charge-point-brand-models/",data:r}),U=r=>p.post({url:"/charge-point-brand-models/bulk-delete/",data:r}),D=(r,t)=>p.put({url:`/charge-point-brand-models/${r}/`,data:t}),_={queryAll:k,queryById:O,add:R,del:U,update:D};function T({folder:r,successCallback:t}){const g=async b=>{const{file:h,onSuccess:n,onError:x}=b;try{const l=new FormData;l.append("picture",h),l.append("folder",r);const i=await S.uploadImage(l);i.code===200&&(n(i,h),t(`${i.detail.picture_path}`),j.success(i.message))}catch(l){x(l),j.error("Image upload failed!")}};return e.jsx(B,{listType:"picture-card",customRequest:g,showUploadList:!1,children:e.jsxs("div",{className:"upload-inner",children:[e.jsx(A,{icon:"Add",size:"20",color:"#1CAE70"}),e.jsx("div",{style:{marginTop:4},children:"Upload Picture"})]})})}const{Option:c}=o;function z({visible:r,onClose:t,brandModels:g,updateBrandModels:b,brandMap:h,record:n,onSave:x}){const[l]=a.useForm(),[i,f]=C.useState(!1),[v,I]=C.useState(n?.picture||"");C.useEffect(()=>{r&&n?(l.setFieldsValue(n),I("")):r&&l.resetFields()},[r,n,l]);const P=()=>{l.validateFields().then(async s=>{const m={...s,brand_id:h[s.brand],picture:v};if(delete m.brand,n&&n.id){const u=await _.update(n.id,m);u?.code===200&&(j.success(u.message),x(),t())}else{const u=await _.add(m);u?.code===200&&(j.success(u.message),x(),t())}})},w=s=>{b(s),l.setFieldsValue({brand:s.brand}),f(!1)},q=()=>{l.setFieldsValue({brand_model:void 0})},E=s=>{l.setFieldsValue({connector_type:s==="AC"?"ac - type2":"dc - ccs2"})},M=s=>{I(s)};return e.jsxs(e.Fragment,{children:[e.jsx(N,{title:n?"Edit Charge Point Brand Model":"Add Charge Point Brand Model",open:r,onCancel:t,zIndex:1001,footer:[e.jsxs("div",{className:"footer-normal-btns",children:[e.jsx(y,{onClick:t,children:"Cancel"},"cancel"),e.jsx(y,{type:"primary",onClick:P,children:n?"Confirm":"Add"},"confirm")]},"footer-normal-btns")],children:e.jsx("div",{className:"modal-form",children:e.jsxs(a,{form:l,layout:"vertical",children:[e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"brand",label:"Brand",rules:[{required:!0,message:"Please select a brand"}],children:e.jsx(o,{onChange:q,placeholder:"Select",disabled:!!n,dropdownRender:s=>e.jsxs("div",{children:[s,e.jsx("div",{className:"p-2",children:e.jsxs(y,{type:"link",onClick:()=>f(!0),children:[e.jsx(F,{})," Add Brand"]})})]}),children:Object.keys(g).map((s,m)=>e.jsx(o.Option,{value:s,children:s},`${s}${m}`))})}),e.jsx(a.Item,{name:"brand_model",label:"Brand Model",rules:[{required:!0,message:"Please Input a brand model"}],children:e.jsx(d,{placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"charge_model",label:"Charge Model",rules:[{required:!0,message:"Please select a charge model"}],children:e.jsxs(o,{placeholder:"Select",onChange:s=>E(s),children:[e.jsx(c,{value:"AC",children:"AC"}),e.jsx(c,{value:"DC",children:"DC"})]})}),e.jsx(a.Item,{name:"connector_type",label:"Connector Type",rules:[{required:!0,message:"Please select a connector type"}],children:e.jsx(d,{disabled:!0,placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"connector_no",label:"Connector No",rules:[{required:!0,message:"Please select a connector number"}],children:e.jsxs(o,{placeholder:"Select",children:[e.jsx(c,{value:1,children:"1"}),e.jsx(c,{value:2,children:"2"})]})}),e.jsx(a.Item,{name:"phase",label:"Phase",rules:[{required:!0,message:"Please enter the phase"}],children:e.jsxs(o,{placeholder:"Select",children:[e.jsx(c,{value:"1p+n",children:"1p+n"}),e.jsx(c,{value:"3p+n",children:"3p+n"})]})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"ocpp",label:"OCPP",rules:[{required:!0,message:"Please enter the OCPP"}],children:e.jsxs(o,{placeholder:"Select",children:[e.jsx(c,{value:"ocpp2.0.1",children:"ocpp2.0.1"}),e.jsx(c,{value:"ocpp1.6",children:"ocpp1.6"})]})}),e.jsx(a.Item,{label:""})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"out_current_min",label:"Current Min(A)",rules:[{required:!0,message:"Please enter the min current"}],children:e.jsx(d,{type:"number",placeholder:"Enter"})}),e.jsx(a.Item,{name:"out_current_max",label:"Current Max(A)",rules:[{required:!0,message:"Please enter the max current"}],children:e.jsx(d,{type:"number",placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"out_voltage_min",label:"Voltage Min(V)",rules:[{required:!0,message:"Please enter the min voltage"}],children:e.jsx(d,{type:"number",placeholder:"Enter"})}),e.jsx(a.Item,{name:"out_voltage_max",label:"Voltage Max(V)",rules:[{required:!0,message:"Please enter the max voltage"}],children:e.jsx(d,{type:"number",placeholder:"Enter"})})]}),e.jsxs("div",{className:"two-column",children:[e.jsx(a.Item,{name:"out_power_min",label:"Power Min(kW)",rules:[{required:!0,message:"Please enter the min power"}],children:e.jsx(d,{type:"number",placeholder:"Enter"})}),e.jsx(a.Item,{name:"out_power_max",label:"Power Max(kW)",rules:[{required:!0,message:"Please enter the max power"}],children:e.jsx(d,{type:"number",placeholder:"Enter"})})]}),e.jsx(a.Item,{name:"picture",label:"Picture",children:e.jsxs("div",{className:"upload-wrapper",children:[v&&e.jsx(V,{src:v,preview:!1,width:236,className:"entity-image mr-4 object-cover"}),e.jsx(T,{folder:"charge_point_brand_model",successCallback:M})]})})]})})}),e.jsx($,{visible:i,onClose:()=>f(!1),onAdd:w})]})}const G=Object.freeze(Object.defineProperty({__proto__:null,default:z},Symbol.toStringTag,{value:"Module"}));export{z as E,_ as c,G as e};
